o<move_tool_to_carousel_height> sub
; #<atc_z_tool_change_height> is the height your spindle needs to be at to clamp/unclamp a tool from the ATC (Set via INI [ATC]Z_TOOL_CHANGE_HEIGHT)
; #<atc_z_tool_clearance_height> is the clearance height your spindle needs to be at to safely clear the ATC (Set via INI [ATC]Z_TOOL_CLEARANCE_HEIGHT)
; #<atc_x_tool_change_pos> is the X position for tool change (Set via INI [ATC]X_TOOL_CHANGE_POS)
; #<atc_y_tool_change_pos> is the Y position for tool change (Set via INI [ATC]Y_TOOL_CHANGE_POS)
(PRINT, o<move_tool_to_carousel_height> - Moving to tool change height)

; Load Z parameters from INI
#<atc_z_tool_change_height> = -3.9000
o100 if [EXISTS[#<_ini[atc]z_tool_change_height>]]
    #<atc_z_tool_change_height> = #<_ini[atc]z_tool_change_height>
o100 endif
#<atc_z_tool_clearance_height> = [#<_ini[AXIS_Z]MAX_LIMIT>-0.01]
o110 if [EXISTS[#<_ini[atc]z_tool_clearance_height>]]
    #<atc_z_tool_clearance_height> = #<_ini[atc]z_tool_clearance_height>
o110 endif

; Load X tool change parameter from INI
#<atc_x_tool_change_pos> = -20.0000
o120 if [EXISTS[#<_ini[atc]x_tool_change_pos>]]
    #<atc_x_tool_change_pos> = #<_ini[atc]x_tool_change_pos>
o120 endif

; Load Y tool change parameter from INI
#<atc_y_tool_change_pos> = -10.0000
o130 if [EXISTS[#<_ini[atc]y_tool_change_pos>]]
    #<atc_y_tool_change_pos> = #<_ini[atc]y_tool_change_pos>
o130 endif

; First move Z to clearance height for safety
G0 G53 Z#<atc_z_tool_clearance_height>

; Then move to X,Y tool change position
G0 G53 X#<atc_x_tool_change_pos> Y#<atc_y_tool_change_pos>

; Finally move Z to tool change height
G0 G53 Z#<atc_z_tool_change_height> ; move to exact tool change height

(PRINT, o<move_tool_to_carousel_height> - At tool change position)
o<move_tool_to_carousel_height> endsub [1]

M2
